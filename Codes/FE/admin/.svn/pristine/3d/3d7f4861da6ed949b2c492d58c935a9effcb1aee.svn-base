<template>
<div class="bread-crumb1">
    <el-breadcrumb separator-class="el-icon-arrow-right">
		<el-breadcrumb-item :to="{ path: item.href }" v-for="(item, index) in breadList" :key="index">{{item.title}}</el-breadcrumb-item>
	</el-breadcrumb>
</div>
</template>
<script scoped>
import menusConfig from '../config/sidebar'
import { constants } from 'crypto';
import eventBus from '../utils/eventBus.js'
export default {
    name:'BreadCrumb',
    componentName:'BreadCrumb',
    props:{

    },
    data(){
        return{
			activeIndex: '',
			breadList: [],
			terminal: false
        }
	},
    mounted(){
		this.getActiveItem(menusConfig, '');
		if(this.activeIndex) this.getBreadList();
		eventBus.$on('initBreadCrumb', (item) => {
			this.terminal = false;
			this.tempList = [];
			this.getActiveItem(menusConfig, '');
			if(this.terminal) this.breadList = this.tempList;
		});
    },
    methods:{
        getActiveItem(menu, index) {
			let self = this, _index = index !== '' ? index + '-' : '';
			_.each(menu, (item, index1) => {
				if(self.$route.name == item.key) {
					self.activeIndex = _index + index1;
				}
				if(!self.activeIndex && !!item.children && item.children.length > 0) {
					self.getActiveItem(item.children, _index + index1);
				}
			});
		},
		getBreadList() {
			let self = this, _indexArr = this.activeIndex.split('-');
			switch(_indexArr.length){
				case 1: 
				self.breadList.push(menusConfig[parseInt(_indexArr[0])]);
				break;
				case 2: 
				self.breadList.push(menusConfig[parseInt(_indexArr[0])].children[parseInt(_indexArr[1])]);
				break;
				case 3: 
				self.breadList.push(menusConfig[parseInt(_indexArr[0])].children[parseInt(_indexArr[1])].children[parseInt(_indexArr[2])]);
				break;
			}
		}
    }   
}
</script>
<style scoped>
.bread-crumb1{
	height: 30px;
	line-height: 30px;
	padding-left: 10px;
	background: #dbdbdb;
}
.bread-crumb1 >>> .el-breadcrumb{
	height: 100%;
	line-height: 30px !important;
	font-size: 12px;
}
</style>


